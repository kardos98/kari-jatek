<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>J√°t√©k kar√°csonyi d√≠szekkel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: linear-gradient(180deg, #ffefef, #ffe4f0, #fff8e8);
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      background-attachment: fixed;
    }

    .game-container {
      background: rgba(255, 255, 255, 0.85);
      padding: 20px 24px;
      border-radius: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      max-width: 520px;
      width: 100%;
      backdrop-filter: blur(4px);
    }

    h1 {
      font-size: 1.6rem;
      margin-top: 0;
      margin-bottom: 0.5rem;
      text-align: center;
      color: #b30000;
    }

    .subtitle {
      font-size: 0.95rem;
      color: #444;
      text-align: center;
      margin-bottom: 1.2rem;
      line-height: 1.4;
    }

    .start-section {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      margin-bottom: 1rem;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 1rem;
      cursor: pointer;
      background: #e0e0e0;
      transition: background 0.15s, transform 0.05s;
    }

    button:hover:not(:disabled) {
      background: #d0d0d0;
    }

    button:active:not(:disabled) {
      transform: scale(0.97);
    }

    button.primary {
      background: #c62828;
      color: white;
    }

    button.primary:hover:not(:disabled) {
      background: #b71c1c;
    }

    button:disabled {
      opacity: 0.5;
      cursor: default;
    }

    .status {
      margin: 10px 0;
      padding: 10px 14px;
      border-radius: 12px;
      background: #fff3f3;
      font-size: 1rem;
      min-height: 1.4em;
      border-left: 4px solid #c62828;
    }

    .status.ended {
      background: #ffe6e6;
    }

    .dots-wrapper {
      margin: 16px 0;
    }

    .dots-label {
      font-size: 0.95rem;
      margin-bottom: 6px;
      font-weight: bold;
    }

    .dots {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      padding: 8px 0;
      min-height: 60px;
      justify-content: center;
    }

    .dot {
      font-size: 32px;
      line-height: 1;
      transition: transform 0.1s, opacity 0.1s;
    }

    .dot.removed {
      opacity: 0.12;
      transform: scale(0.65);
    }

    .controls {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 10px;
      margin-bottom: 8px;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <h1>J√°t√©k kar√°csonyi d√≠szekkel</h1>
    <div class="subtitle">
      2 j√°t√©kos j√°tszik, minden l√©p√©sben 1 vagy 2 d√≠szt vehettek el.<br>
      Az vesz√≠t, aki az utols√≥ d√≠szt viszi el.
    </div>

    <div class="start-section">
      <button id="playerStartsBtn" class="primary">√ân kezdek</button>
      <button id="computerStartsBtn">Sz√°m√≠t√≥g√©p kezd</button>
      <button id="resetBtn">√öj j√°t√©k</button>
    </div>

    <div id="status" class="status"></div>

    <div class="dots-wrapper">
      <div class="dots-label">H√°tral√©v≈ë d√≠szek: <span id="remainingCount">17</span></div>
      <div id="dots" class="dots"></div>
    </div>

    <div class="controls">
      <button id="take1Btn" disabled>1 d√≠szt veszek el</button>
      <button id="take2Btn" disabled>2 d√≠szt veszek el</button>
    </div>
  </div>

  <script>
    const TOTAL_DOTS = 17;

    let remaining = TOTAL_DOTS;
    let currentPlayer = null;
    let gameOver = false;

    const statusEl = document.getElementById('status');
    const remainingEl = document.getElementById('remainingCount');
    const dotsContainer = document.getElementById('dots');

    const take1Btn = document.getElementById('take1Btn');
    const take2Btn = document.getElementById('take2Btn');
    const playerStartsBtn = document.getElementById('playerStartsBtn');
    const computerStartsBtn = document.getElementById('computerStartsBtn');
    const resetBtn = document.getElementById('resetBtn');

    const ORNAMENTS = ['üéÑ','üéÅ','‚ú®','üîî','üéÄ','‚≠ê'];

    function initDots() {
      dotsContainer.innerHTML = '';
      for (let i = 0; i < TOTAL_DOTS; i++) {
        const dot = document.createElement('div');
        dot.className = 'dot';
        dot.textContent = ORNAMENTS[i % ORNAMENTS.length];
        dotsContainer.appendChild(dot);
      }
    }

    function updateDots() {
      const dots = dotsContainer.querySelectorAll('.dot');
      dots.forEach((dot, index) => {
        if (index < remaining) {
          dot.classList.remove('removed');
        } else {
          dot.classList.add('removed');
        }
      });
    }

    function setStatus(message, ended = false) {
      statusEl.textContent = message;
      statusEl.classList.toggle('ended', ended);
    }

    function setHumanControls(enabled) {
      take1Btn.disabled = !enabled || gameOver || remaining <= 0;
      take2Btn.disabled = !enabled || gameOver || remaining <= 1;
    }

    function resetGame() {
      remaining = TOTAL_DOTS;
      currentPlayer = null;
      gameOver = false;
      remainingEl.textContent = remaining;
      initDots();
      updateDots();
      setStatus('V√°laszd ki, ki kezdi a j√°t√©kot.');
      setHumanControls(false);
    }

    function computerBestMove(n) {
      if (n === 1) return 1;
      if (n === 2) return 1;
      if (n === 3) return 2;

      for (let k of [1, 2]) {
        const after = n - k;
        if (after > 0 && (after - 1) % 3 === 0) {
          return k;
        }
      }

      const maxTake = Math.min(2, n);
      return Math.floor(Math.random() * maxTake) + 1;
    }

    function applyMove(player, taken) {
      if (gameOver) return;
      remaining -= taken;
      remainingEl.textContent = remaining;
      updateDots();

      if (remaining === 0) {
        // Az vesz√≠t, aki az utols√≥ d√≠szt viszi el.
        if (player === 'human') {
          setStatus('Vesztett√©l, te vitted el az utols√≥ d√≠szt. üò¢', true);
        } else {
          setStatus('Gratul√°lok, a jelsz√≥: kar√°csonyfa üéÑ', true);
        }
        gameOver = true;
        setHumanControls(false);
        return;
      }

      if (player === 'human') {
        currentPlayer = 'computer';
        setHumanControls(false);
        setStatus('A sz√°m√≠t√≥g√©p gondolkodik...');
        setTimeout(computerTurn, 600);
      } else {
        currentPlayer = 'human';
        setStatus('Te k√∂vetkezel. V√°laszd ki, h√°ny d√≠szt viszel el.');
        setHumanControls(true);
      }
    }

    function computerTurn() {
      if (gameOver) return;
      const move = computerBestMove(remaining);
      applyMove('computer', move);
    }

    function startGame(starter) {
      resetGame();
      currentPlayer = starter;

      if (starter === 'human') {
        setStatus('Te kezdesz. V√°laszd ki, h√°ny d√≠szt viszel el (1 vagy 2).');
        setHumanControls(true);
      } else {
        setStatus('A sz√°m√≠t√≥g√©p kezd.');
        setHumanControls(false);
        setTimeout(computerTurn, 600);
      }
    }

    take1Btn.addEventListener('click', () => {
      if (currentPlayer === 'human') applyMove('human', 1);
    });

    take2Btn.addEventListener('click', () => {
      if (currentPlayer === 'human') applyMove('human', 2);
    });

    playerStartsBtn.addEventListener('click', () => startGame('human'));
    computerStartsBtn.addEventListener('click', () => startGame('computer'));
    resetBtn.addEventListener('click', () => resetGame());

    resetGame();
  </script>
</body>
</html>